#     __  __                 __                __
#    / / / /_  ______  _____/ /___ _____  ____/ /
#   / /_/ / / / / __ \/ ___/ / __ `/ __ \/ __  / 
#  / __  / /_/ / /_/ / /  / / /_/ / / / / /_/ /  
# /_/ /_/\__, / .___/_/  /_/\__,_/_/ /_/\__,_/   
#       /____/_/                                 
#
# AUTHOR = MHD
# WIKI = https://wiki.hyprland.org/Configuring

# GPU for Hyprland rendering
env = AQ_DRM_DEVICES,/dev/dri/card0:/dev/dri/card1 # In my case card0 is amd  radeon vega 10 and card1 is nvidia 1660ti (Ordered by priority)

# Launch essential services
exec-once = mako > /dev/null 2>&1
exec-once = ~/.config/wayland/scripts/mako-logging > /dev/null 2>&1
exec-once = /usr/libexec/polkit-gnome-authentication-agent-1 > /dev/null 2>&1
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP > /dev/null 2>&1
exec-once = ~/.config/wayland/scripts/rice-init > /dev/null 2>&1
exec-once = fcitx5 > /dev/null 2>&1


env = XDG_SESSION_TYPE, wayland
env = XDG_CURRENT_DESKTOP, Hyprland
env = XDG_SESSION_DESKTOP, Hyprland
env = XCURSOR_SIZE,28

# Variables for nvidia drivers
env = LIBVA_DRIVER_NAME,nvidia
env = __GLX_VENDOR_LIBRARY_NAME,nvidia

# Monitors
monitor = ,preferred,auto,1

# styles
source = ~/.config/wayland/hypr/borders.conf

misc {
    disable_hyprland_logo = true
    disable_splash_rendering = true
    force_default_wallpaper = -1
}

cursor {

    sync_gsettings_theme = true # make all gtk themes work with gsettings
    no_break_fs_vrr = 2 # 1= on, 2= auto, 0= off, helps with VRR in games
    min_refresh_rate = 24 # min refresh rate for cursor movement for VRR in games
    inactive_timeout = 0 # hide cursor when it's inactive (in seconds)
    # default_monitor = HDMI-A-1 # the name of the monitor for cursor to show up at startup
    enable_hyprcursor = false # enables hyprcursor
    hide_on_key_press = true # hides the cursor when a key being pressed on keyboard

}

# OpenGL
opengl {

    nvidia_anti_flicker = true

}

input {
    kb_layout = us
}

decoration {
    blur {
        enabled = false
        size = 8
        passes = 2         # More passes = smoother blur
        vibrancy = 0.15    # Adds a subtle glow (optional)
        ignore_opacity = true
    }
    
    # Shadow settings (newer syntax)
    shadow {
        enabled = true
        range = 10
        render_power = 4
        color = rgba(1a1a1aee)
        offset = 4 4
    }
}


# Rendering
render {

    direct_scanout = 2 # if your game is in fullscreen this can help you, you can also put it at 2 to make it auto for detecting games and stuff

}

#     _____           _       __      
#   / ___/__________(_)___  / /______
#   \__ \/ ___/ ___/ / __ \/ __/ ___/
#  ___/ / /__/ /  / / /_/ / /_(__  ) 
# /____/\___/_/  /_/ .___/\__/____/  
#                 /_/                

# Resize the floating windows
$screen_width = $(hyprctl -j monitors | jq '.[0].width')
$screen_height = $(hyprctl -j monitors | jq '.[0].height')
$half_width = $((screen_width / 2))
$half_height = $((screen_height / 2))

windowrulev2 = size $half_width $half_height, floating:1
windowrulev2 = center, floating:1

# float window for some of the scripts
windowrulev2 = float, title:^(Hypr Cheatsheet)$
windowrulev2 = center, title:^(Hypr Cheatsheet)$

#     __ __           __    _           ___                 
#    / //_/__  __  __/ /_  (_)___  ____/ (_)___  ____ ______
#   / ,< / _ \/ / / / __ \/ / __ \/ __  / / __ \/ __ `/ ___/
#  / /| /  __/ /_/ / /_/ / / / / / /_/ / / / / / /_/ (__  ) 
# /_/ |_\___/\__, /_.___/_/_/ /_/\__,_/_/_/ /_/\__, /____/  
#           /____/                            /____/        

############################
# ----- Applications ----- #
############################

# ----- Cheatsheet ----- #
bind = SUPER ALT, c, exec, ~/.config/wayland/scripts/cheatsheet

# ----- Main Apps ----- #
bind = SUPER, Return, exec, kitty --config ~/.config/wayland/kitty/kitty.conf # Terminal
bind = SUPER, SPACE, exec, rofi -show drun -theme ~/.config/wayland/scripts/rofi-themes/dmenu.rasi # App launcher
bind = ALT, SPACE, exec, ~/.config/wayland/scripts/rice-selector # Rice selector
bind = SUPER ALT, w, exec, ~/.config/wayland/scripts/wallpaper-selector # wallpaper selector
bind = SUPER ALT, a, exec, ~/.config/wayland/scripts/script-selector

# ----- Common Apps ----- #
bind = SHIFT + ALT, b, exec, firefox # Browser
bind = SHIFT + ALT, w, exec, firefox https://web.whatsapp.com # Whatsapp
bind = SHIFT + ALT, i, exec, ~/.config/wayland/scripts/web-ai-selector # AI Websites list
bind = SHIFT + ALT, t, exec, Telegram # Telegram app
bind = SHIFT ALT, v, exec, kitty -c ~/.config/wayland/kitty/kitty.conf -e nvim  # Terminal editor


# ----- System Utilities ----- #

# Screenshot with slurp
bind = SUPER ALT, s, exec, grim -g "$(slurp)" ~/Pictures/screenshot_$(date +%Y%m%d_%H%M).png && wl-copy < ~/Pictures/screenshot_$(date +%Y%m%d_%H%M).png && notify-send "Screenshot" "Screenshot saved"  # Screenshot (grim+slurp)

# Audio-switcher
bind = SUPER ALT, p, exec, ~/.config/wayland/scripts/audio-switcher

# Bar controls
bind = SUPER, b, exec, killall -SIGUSR1 waybar  # Toggle bar

# Brightness controls (using Brightnessctl)
binde = , XF86MonBrightnessDown, exec, brightnessctl set 5%- && notify-send -c ~/.config/wayland/mako/config.ini -h string:x-canonical-private-synchronous:brightness "Brightness" "$(($(brightnessctl get) * 100 / $(brightnessctl max)))%" -h int:value:"$(($(brightnessctl get) * 100 / $(brightnessctl max)))"


binde = , XF86MonBrightnessUp, exec, brightnessctl set 5%+ && notify-send -c ~/.config/wayland/mako/config.ini -h string:x-canonical-private-synchronous:brightness "Brightness" "$(($(brightnessctl get) * 100 / $(brightnessctl max)))%" -h int:value:"$(($(brightnessctl get) * 100 / $(brightnessctl max)))"


# Volume controls (install pipewire/wireplumber)
binde = , XF86AudioRaiseVolume, exec, wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%+ && notify-send -c ~/.config/wayland/mako/config.ini -h string:x-canonical-private-synchronous:volume "Volume" "$(wpctl get-volume @DEFAULT_AUDIO_SINK@ | awk '{print $2 * 100}')%" -h int:value:"$(wpctl get-volume @DEFAULT_AUDIO_SINK@ | awk '{print $2 * 100}')"


binde = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%- && notify-send -c ~/.config/wayland/mako/config.ini -h string:x-canonical-private-synchronous:volume "Volume" "$(wpctl get-volume @DEFAULT_AUDIO_SINK@ | awk '{print $2 * 100}')%" -h int:value:"$(wpctl get-volume @DEFAULT_AUDIO_SINK@ | awk '{print $2 * 100}')"


bind = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle && (wpctl get-volume @DEFAULT_AUDIO_SINK@ | grep -q MUTED && notify-send -c ~/.config/wayland/mako/config.ini -h string:x-canonical-private-synchronous:volume "Volume" "Muted" -h int:value:0 || notify-send -c ~/.config/wayland/mako/config.ini -h string:x-canonical-private-synchronous:volume "Volume" "Unmuted" -h int:value:"$(wpctl get-volume @DEFAULT_AUDIO_SINK@ | awk '{print $2 * 100}')")



# keyboard backlight
binde = , XF86KbdBrightnessDown, exec, brightnessctl -d asus::kbd_backlight set 5%- && notify-send -c ~/.config/wayland/mako/config.ini -h string:x-canonical-private-synchronous:kbdlight "Keyboard Backlight" "$(($(brightnessctl -d asus::kbd_backlight get) * 100 / $(brightnessctl -d asus::kbd_backlight max)))%" -h int:value:"$(($(brightnessctl -d asus::kbd_backlight get) * 100 / $(brightnessctl -d asus::kbd_backlight max)))"

binde = , XF86KbdBrightnessUp, exec, brightnessctl -d asus::kbd_backlight set 5%+ && notify-send -c ~/.config/wayland/mako/config.ini -h string:x-canonical-private-synchronous:kbdlight "Keyboard Backlight" "$(($(brightnessctl -d asus::kbd_backlight get) * 100 / $(brightnessctl -d asus::kbd_backlight max)))%" -h int:value:"$(($(brightnessctl -d asus::kbd_backlight get) * 100 / $(brightnessctl -d asus::kbd_backlight max)))"




#################################
# ----- Window Management ----- #
#################################

# Close/Kill window
bind = SUPER, q, killactive

# Reload Hyprland
bind = SUPER ALT, r, exec, hyprctl reload && notify-send -c ~/.config/wayland/mako/config.ini "Hyprland" "Configuration reloaded"

# Window states
bind = SUPER, t, exec, hyprctl dispatch togglefloating active; hyprctl dispatch resizeactive exact 50% 50%; hyprctl dispatch centerwindow
bind = SUPER, f, fullscreen

# Focus movement
bind = SUPER, h, movefocus, l
bind = SUPER, l, movefocus, r
bind = SUPER, k, movefocus, u
bind = SUPER, j, movefocus, d

# Move window
bind = SUPER SHIFT, h, swapwindow, l
bind = SUPER SHIFT, l, swapwindow, r
bind = SUPER SHIFT, k, swapwindow, u
bind = SUPER SHIFT, j, swapwindow, d

# Workspace navigation
bind = SUPER CTRL, h, workspace, -1
bind = SUPER CTRL, l, workspace, +1

# Move Node to workspace
bind = SUPER SHIFT, 1, movetoworkspace, 1
bind = SUPER SHIFT, 2, movetoworkspace, 2
bind = SUPER SHIFT, 3, movetoworkspace, 3
bind = SUPER SHIFT, 4, movetoworkspace, 4
bind = SUPER SHIFT, 5, movetoworkspace, 5
bind = SUPER SHIFT, 6, movetoworkspace, 6

# Move Node to workspace manually
bind = SUPER SHIFT CTRL, h, movetoworkspace, -1
bind = SUPER SHIFT CTRL, l, movetoworkspace, +1

# Switch workspace
bind = SUPER, 1, workspace, 1
bind = SUPER, 2, workspace, 2
bind = SUPER, 3, workspace, 3
bind = SUPER, 4, workspace, 4
bind = SUPER, 5, workspace, 5
bind = SUPER, 6, workspace, 6

# Last window/workspace
bind = SUPER, grave, focuscurrentorlast

# Resize windows
binde = SUPER ALT, h, resizeactive, -10 0
binde = SUPER ALT, l, resizeactive, 10 0
binde = SUPER ALT, k, resizeactive, 0 -10
binde = SUPER ALT, j, resizeactive, 0 10

# Changes the transparency of the current window
bind = CTRL ALT, equal, exec, hyprctl --batch "keyword decoration:active_opacity 1.0; keyword decoration:inactive_opacity 1.0"
bind = CTRL ALT, minus, exec, hyprctl --batch "keyword decoration:active_opacity 0.85; keyword decoration:inactive_opacity 0.85"

# Moving Floating Windows
bindm = SUPER, mouse:272, movewindow

# Monitor rotation
bind = SUPER ALT, m, exec, hyprctl keyword monitor "$(hyprctl monitors -j | jq -r '.[1].name')",transform,"$(( $(hyprctl monitors -j | jq -r '.[1].transform') == 0 ? 1 : 0 ))"

# Toggle minimize/restore current window
bind = CTRL ALT, h, exec, ~/.config/wayland/scripts/minimize-toggle

# Toggle blur
bind = CTRL ALT, 0, exec, hyprctl keyword decoration:blur:enabled "$(( $(hyprctl getoption decoration:blur:enabled -j | jq '.int') == 0 ? 1 : 0 ))"

# Keyboard Language menu
bind = SUPER ALT, space, exec, ~/.config/wayland/scripts/keyboard-layout

# Obsidian app
bind = SHIFT ALT, n, exec, obsidian
